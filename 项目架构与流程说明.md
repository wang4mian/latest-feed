# 制造业情报系统 - 项目架构与流程说明

## 🏗️ 核心目标
**全自动化：抓取特定制造业领域相关的高价值情报文章**，帮助制造业从业者及时获取行业动态以及监控竞品和行业动态。

## 🔄 完整工作流程

### 第一阶段：内容收集
```
RSS源 → Vercel Cron定时抓取 → Articles表(status: pending)
```
- **RSS源**：43个制造业相关RSS（Google News、3D打印、工业4.0等）
- **定时抓取**：每天8点、14点、20点自动执行
- **初步存储**：直接存为pending状态的文章

### 第二阶段：内容分析（AI处理）
```
Pending Articles → Crawl4AI抓取全文 → Gemini AI分析评分 → Articles表(status: processed)
```
- **全文抓取**：Crawl4AI获取文章完整内容（突破paywall）
- **AI分析**：Gemini AI进行内容分析、价值评分、受众定位
- **智能筛选**：根据AI评分过滤低价值内容

### 第三阶段：人工筛选
```
Processed Articles → 人工审核(/articles页面) → 采用/忽略决策
```
- **文章池**：所有AI处理后的文章展示
- **人工判断**：编辑决定采用(adopted)或忽略(ignored)
- **质量控制**：人工确保内容质量和相关性

### 第四阶段：内容编辑发布
```
Adopted Articles → 编辑台(/workbench) → Doocs MD编辑器 → 最终发布
```
- **编辑台**：集成Doocs Markdown编辑器
- **内容加工**：标题优化、内容整理、格式美化
- **发布输出**：生成最终的情报文章

## 🎯 关键特性

### 智能化程度
- **全自动RSS抓取** - 无需人工干预
- **AI智能分析** - 自动评估内容价值
- **智能去重** - 避免重复内容

### 效率优化
- **批量处理** - 一次处理多个RSS源
- **定时执行** - 每日3次自动更新
- **状态管理** - 清晰的文章处理状态

### 质量控制
- **AI+人工双重筛选** - 确保内容质量
- **价值评分系统** - 筛选高价值内容
- **受众定位** - 确保内容精准性

## 📊 数据流转

```
RSS Sources → Articles(pending) → Articles(processed) → Articles(adopted) → 发布
     ↓              ↓                    ↓                    ↓
  定时抓取      → AI分析处理        → 人工筛选        → 编辑发布
```

## 🔧 技术架构
- **前端**：Astro + TailwindCSS（响应式界面）
- **后端**：Vercel Serverless Functions
- **数据库**：Supabase PostgreSQL
- **AI服务**：Crawl4AI + Gemini AI
- **定时任务**：Vercel Cron
- **编辑器**：Doocs MD

## 📋 详细流程说明

### 1. RSS源管理
- **源配置**：`src/lib/rss-sources.ts`中定义43个RSS源
- **分类管理**：按3D打印、制造业、工业4.0等分类
- **状态控制**：支持启用/禁用单个RSS源

### 2. 自动抓取机制
- **Vercel Cron**：`vercel.json`配置定时任务
- **执行时间**：每天8:00、14:00、20:00
- **抓取API**：`/api/fetch-rss`执行实际抓取
- **存储格式**：直接存储为articles表记录

### 3. AI处理流程
- **触发方式**：手动调用`/api/process-rss`
- **内容抓取**：Crawl4AI获取完整文章内容
- **AI分析**：Gemini AI分析内容价值和受众
- **评分系统**：1-100分的价值评分
- **状态更新**：pending → processed

### 4. 人工审核界面
- **文章池页面**：`/articles`展示所有processed文章
- **操作选项**：采用/忽略按钮
- **筛选功能**：按状态、评分、时间筛选
- **批量操作**：支持批量采用/忽略

### 5. 编辑发布工具
- **编辑台页面**：`/workbench`集成编辑器
- **Doocs MD**：功能完整的Markdown编辑器
- **内容优化**：标题、摘要、格式调整
- **发布管理**：最终文章输出

## 🚀 部署架构

### 生产环境
- **域名**：`feed.intelliexport.com`
- **CDN**：Vercel Edge Network
- **运行时**：Node.js 18.x Serverless
- **数据库**：Supabase云端PostgreSQL

### 环境变量配置
```bash
# AI服务
GEMINI_API_KEY=your_gemini_key
CRAWL4AI_CLOUD_URL=https://www.crawl4ai-cloud.com/query
CRAWL4AI_API_KEY=your_crawl4ai_key

# 数据库
SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
SUPABASE_ANON_KEY=your_anon_key

# 安全
CRON_SECRET=your_cron_secret
```

## 📈 监控与维护

### 系统监控
- **RSS抓取状态**：`/api/fetch-rss` GET请求查看统计
- **系统健康**：`/api/health`检查各服务状态
- **数据统计**：`/api/stats`查看整体数据概况

### 日志查看
- **Vercel Functions**：查看cron执行日志
- **Supabase Logs**：数据库操作记录
- **API响应**：各接口调用状态

### 维护任务
- **RSS源维护**：定期检查失效源，添加新源
- **AI参数调优**：根据效果调整AI分析参数
- **内容质量监控**：人工抽查AI处理质量

## ✅ 项目完成状态

### 已实现功能
- [x] RSS源多渠道抓取（43个专业源）
- [x] Vercel Cron自动定时任务（每日3次）
- [x] Crawl4AI智能内容提取
- [x] Gemini AI内容分析与评分
- [x] Supabase数据库存储与管理
- [x] 响应式Web界面
- [x] 完整API接口体系
- [x] 生产环境部署

### 待优化功能
- [ ] 文章去重算法优化
- [ ] AI分析准确性提升
- [ ] 编辑工作流完善
- [ ] 用户权限管理
- [ ] 内容推荐算法
- [ ] 移动端优化

## 💡 核心价值

**本质上是一个"内容情报生产流水线"，从原始RSS到精品文章的全自动化处理系统！**

通过AI+人工的协作模式，实现：
- **效率提升**：自动化处理大量信息源
- **质量保证**：AI筛选+人工审核双重保障
- **内容聚焦**：专注制造业垂直领域
- **实时更新**：每日多次自动更新

---
*文档创建时间：2025-08-25*  
*最后更新：RSS定时抓取系统完整部署*