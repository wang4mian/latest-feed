/* empty css                                    */
import { c as createComponent, f as renderComponent, e as renderTemplate, m as maybeRenderHead, b as addAttribute } from '../chunks/astro/server_0DBvwa-7.mjs';
import 'kleur/colors';
import { $ as $$Layout } from '../chunks/Layout_D1faHx2S.mjs';
import { s as supabase } from '../chunks/supabase_Dfi1qjCo.mjs';
/* empty css                                     */
export { renderers } from '../renderers.mjs';

const $$Dashboard = createComponent(async ($$result, $$props, $$slots) => {
  const { data: articles } = await supabase.from("articles").select("*").order("created_at", { ascending: false });
  const { data: rssResources } = await supabase.from("rss_sources").select("*").order("success_rate", { ascending: false });
  const totalArticles = articles?.length || 0;
  const processedArticles = articles?.filter((a) => a.status === "processed").length || 0;
  articles?.filter((a) => a.editor_action === "compiled").length || 0;
  const averageScore = articles?.length ? (articles.reduce((sum, a) => {
    const score = a.ai_analysis?.value_score || 0;
    return sum + score;
  }, 0) / articles.length).toFixed(1) : "0";
  const totalRssResources = rssResources?.length || 0;
  const activeRssResources = rssResources?.filter((r) => r.is_active).length || 0;
  const healthRate = totalRssResources > 0 ? Math.round(activeRssResources / totalRssResources * 100) : 0;
  const statusGroups = articles?.reduce((acc, article) => {
    acc[article.status] = (acc[article.status] || 0) + 1;
    return acc;
  }, {}) || {};
  const recent = articles?.filter((a) => {
    const createdAt = new Date(a.created_at);
    const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1e3);
    return createdAt > weekAgo;
  }) || [];
  const highValueArticles = articles?.filter((a) => (a.ai_analysis?.value_score || 0) >= 8) || [];
  const rssCategories = rssResources?.reduce((acc, source) => {
    if (source.is_active) {
      acc[source.category] = (acc[source.category] || 0) + 1;
    }
    return acc;
  }, {}) || {};
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "Dashboard - \u5236\u9020\u4E1A\u60C5\u62A5\u7CFB\u7EDF", "data-astro-cid-3nssi2tu": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" data-astro-cid-3nssi2tu> <!-- 页面标题 --> <div class="mb-8" data-astro-cid-3nssi2tu> <h1 class="text-3xl font-bold text-gray-900" data-astro-cid-3nssi2tu>📊 系统仪表板</h1> <p class="mt-2 text-gray-600" data-astro-cid-3nssi2tu>制造业情报系统运营概览</p> </div> <!-- 核心指标卡片 --> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" data-astro-cid-3nssi2tu> <!-- 总文章数 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <div class="flex items-center" data-astro-cid-3nssi2tu> <div class="p-3 bg-blue-100 rounded-lg" data-astro-cid-3nssi2tu> <span class="text-2xl" data-astro-cid-3nssi2tu>📰</span> </div> <div class="ml-4" data-astro-cid-3nssi2tu> <p class="text-sm font-medium text-gray-600" data-astro-cid-3nssi2tu>总文章</p> <p class="text-3xl font-semibold text-gray-900" data-astro-cid-3nssi2tu>${totalArticles}</p> </div> </div> </div> <!-- 已处理文章 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <div class="flex items-center" data-astro-cid-3nssi2tu> <div class="p-3 bg-green-100 rounded-lg" data-astro-cid-3nssi2tu> <span class="text-2xl" data-astro-cid-3nssi2tu>✅</span> </div> <div class="ml-4" data-astro-cid-3nssi2tu> <p class="text-sm font-medium text-gray-600" data-astro-cid-3nssi2tu>已处理</p> <p class="text-3xl font-semibold text-gray-900" data-astro-cid-3nssi2tu>${processedArticles}</p> </div> </div> </div> <!-- 平均价值评分 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <div class="flex items-center" data-astro-cid-3nssi2tu> <div class="p-3 bg-yellow-100 rounded-lg" data-astro-cid-3nssi2tu> <span class="text-2xl" data-astro-cid-3nssi2tu>⭐</span> </div> <div class="ml-4" data-astro-cid-3nssi2tu> <p class="text-sm font-medium text-gray-600" data-astro-cid-3nssi2tu>平均评分</p> <p class="text-3xl font-semibold text-gray-900" data-astro-cid-3nssi2tu>${averageScore}</p> </div> </div> </div> <!-- RSS源健康度 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <div class="flex items-center" data-astro-cid-3nssi2tu> <div class="p-3 bg-purple-100 rounded-lg" data-astro-cid-3nssi2tu> <span class="text-2xl" data-astro-cid-3nssi2tu>📡</span> </div> <div class="ml-4" data-astro-cid-3nssi2tu> <p class="text-sm font-medium text-gray-600" data-astro-cid-3nssi2tu>源健康度</p> <p class="text-3xl font-semibold text-gray-900" data-astro-cid-3nssi2tu>${healthRate}%</p> <p class="text-xs text-gray-500" data-astro-cid-3nssi2tu>${activeRssResources}/${totalRssResources}</p> </div> </div> </div> </div> <!-- 图表和详细信息 --> <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8" data-astro-cid-3nssi2tu> <!-- 文章状态分布 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold text-gray-900 mb-4" data-astro-cid-3nssi2tu>📈 文章状态分布</h3> <div class="space-y-4" data-astro-cid-3nssi2tu> ${Object.entries(statusGroups).map(([status, count]) => {
    const percentage = totalArticles > 0 ? Math.round(count / totalArticles * 100) : 0;
    const statusEmoji = {
      "new": "\u{1F195}",
      "processing": "\u26A1",
      "processed": "\u2705",
      "adopted": "\u{1F44D}",
      "ignored": "\u274C",
      "compiled": "\u{1F4DD}",
      "published": "\u{1F680}"
    }[status] || "\u{1F4C4}";
    return renderTemplate`<div class="flex items-center justify-between" data-astro-cid-3nssi2tu> <div class="flex items-center" data-astro-cid-3nssi2tu> <span class="mr-2" data-astro-cid-3nssi2tu>${statusEmoji}</span> <span class="text-sm font-medium text-gray-700" data-astro-cid-3nssi2tu>${status}</span> </div> <div class="flex items-center" data-astro-cid-3nssi2tu> <div class="w-32 bg-gray-200 rounded-full h-2 mr-2" data-astro-cid-3nssi2tu> <div class="bg-blue-500 h-2 rounded-full"${addAttribute(`width: ${percentage}%`, "style")} data-astro-cid-3nssi2tu></div> </div> <span class="text-sm font-semibold text-gray-900 w-8" data-astro-cid-3nssi2tu>${count}</span> </div> </div>`;
  })} </div> </div> <!-- RSS源状态 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold text-gray-900 mb-4" data-astro-cid-3nssi2tu>📡 RSS源状态</h3> <div class="space-y-4" data-astro-cid-3nssi2tu> <div class="flex justify-between items-center" data-astro-cid-3nssi2tu> <span class="text-sm text-gray-600" data-astro-cid-3nssi2tu>总源数</span> <span class="font-semibold" data-astro-cid-3nssi2tu>${totalRssResources}</span> </div> <div class="flex justify-between items-center" data-astro-cid-3nssi2tu> <span class="text-sm text-gray-600" data-astro-cid-3nssi2tu>激活源</span> <span class="font-semibold text-green-600" data-astro-cid-3nssi2tu>${activeRssResources}</span> </div> <div class="flex justify-between items-center" data-astro-cid-3nssi2tu> <span class="text-sm text-gray-600" data-astro-cid-3nssi2tu>健康度</span> <span${addAttribute(`font-semibold ${healthRate >= 80 ? "text-green-600" : healthRate >= 60 ? "text-yellow-600" : "text-red-600"}`, "class")} data-astro-cid-3nssi2tu> ${healthRate}%
</span> </div> <!-- 分类统计 --> <div class="mt-4 pt-4 border-t border-gray-200" data-astro-cid-3nssi2tu> <h4 class="text-sm font-medium text-gray-700 mb-2" data-astro-cid-3nssi2tu>分类分布</h4> ${Object.entries(rssCategories).map(([category, count]) => renderTemplate`<div class="flex justify-between items-center py-1" data-astro-cid-3nssi2tu> <span class="text-xs text-gray-600" data-astro-cid-3nssi2tu>${category}</span> <span class="text-xs font-medium" data-astro-cid-3nssi2tu>${count}</span> </div>`)} </div> </div> </div> </div> <!-- 数据表格 --> <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8" data-astro-cid-3nssi2tu> <!-- 最新文章 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold text-gray-900 mb-4" data-astro-cid-3nssi2tu>📰 最新文章</h3> <div class="space-y-3 max-h-96 overflow-y-auto" data-astro-cid-3nssi2tu> ${recent.slice(0, 10).map((article) => {
    const timeAgo = new Date(article.created_at).toLocaleDateString("zh-CN");
    const scoreColor = (article.ai_analysis?.value_score || 0) >= 8 ? "text-green-600" : (article.ai_analysis?.value_score || 0) >= 6 ? "text-yellow-600" : "text-gray-600";
    return renderTemplate`<div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-0" data-astro-cid-3nssi2tu> <div class="flex-1 min-w-0" data-astro-cid-3nssi2tu> <p class="text-sm font-medium text-gray-900 truncate" data-astro-cid-3nssi2tu> ${article.raw_content?.title || article.source_url?.substring(0, 50) + "..." || "\u65E0\u6807\u9898"} </p> <div class="flex items-center mt-1 space-x-2" data-astro-cid-3nssi2tu> <span class="text-xs text-gray-500" data-astro-cid-3nssi2tu>${timeAgo}</span> <span${addAttribute(`text-xs px-2 py-1 rounded ${article.status === "processed" ? "bg-green-100 text-green-800" : article.status === "compiled" ? "bg-blue-100 text-blue-800" : "bg-gray-100 text-gray-800"}`, "class")} data-astro-cid-3nssi2tu> ${article.status} </span> </div> </div> <div class="ml-4 text-right" data-astro-cid-3nssi2tu> <span${addAttribute(`text-sm font-semibold ${scoreColor}`, "class")} data-astro-cid-3nssi2tu> ${article.ai_analysis?.value_score ? `${article.ai_analysis.value_score}/10` : "-"} </span> </div> </div>`;
  })} </div> </div> <!-- RSS源列表 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold text-gray-900 mb-4" data-astro-cid-3nssi2tu>📡 RSS源状态</h3> <div class="space-y-3 max-h-96 overflow-y-auto" data-astro-cid-3nssi2tu> ${rssResources?.slice(0, 10).map((source) => renderTemplate`<div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-0" data-astro-cid-3nssi2tu> <div class="flex-1 min-w-0" data-astro-cid-3nssi2tu> <p class="text-sm font-medium text-gray-900 truncate" data-astro-cid-3nssi2tu> ${source.name} </p> <div class="flex items-center mt-1 space-x-2" data-astro-cid-3nssi2tu> <span${addAttribute(`text-xs px-2 py-1 rounded ${source.category === "Technology" ? "bg-blue-100 text-blue-800" : source.category === "Business" ? "bg-green-100 text-green-800" : "bg-purple-100 text-purple-800"}`, "class")} data-astro-cid-3nssi2tu> ${source.category} </span> <span class="text-xs text-gray-500" data-astro-cid-3nssi2tu>${source.region}</span> </div> </div> <div class="ml-4 text-right" data-astro-cid-3nssi2tu> <div class="flex items-center space-x-2" data-astro-cid-3nssi2tu> <span${addAttribute(`w-2 h-2 rounded-full ${source.is_active ? "bg-green-500" : "bg-red-500"}`, "class")} data-astro-cid-3nssi2tu></span> ${source.success_rate && renderTemplate`<span class="text-xs text-gray-500" data-astro-cid-3nssi2tu>${source.success_rate}%</span>`} </div> </div> </div>`)} </div> </div> </div> <!-- 高价值文章 --> ${highValueArticles.length > 0 && renderTemplate`<div class="bg-white rounded-lg shadow p-6 mb-8" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold text-gray-900 mb-4" data-astro-cid-3nssi2tu>🏆 高价值文章 (≥8分)</h3> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" data-astro-cid-3nssi2tu> ${highValueArticles.slice(0, 6).map((article) => renderTemplate`<div class="p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow" data-astro-cid-3nssi2tu> <h4 class="text-sm font-medium text-gray-900 mb-2 line-clamp-2" data-astro-cid-3nssi2tu> ${article.raw_content?.title || "\u65E0\u6807\u9898"} </h4> <div class="flex items-center justify-between" data-astro-cid-3nssi2tu> <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded" data-astro-cid-3nssi2tu> ${article.ai_analysis?.value_score}/10
</span> <span class="text-xs text-gray-500" data-astro-cid-3nssi2tu> ${new Date(article.created_at).toLocaleDateString("zh-CN")} </span> </div> ${article.ai_analysis?.target_audience && renderTemplate`<div class="mt-2" data-astro-cid-3nssi2tu> <span class="text-xs text-gray-500" data-astro-cid-3nssi2tu> ${Array.isArray(article.ai_analysis.target_audience) ? article.ai_analysis.target_audience[0] : article.ai_analysis.target_audience} </span> </div>`} </div>`)} </div> </div>`} <!-- 快速操作 --> <div class="bg-white rounded-lg shadow p-6" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold text-gray-900 mb-4" data-astro-cid-3nssi2tu>🚀 快速操作</h3> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" data-astro-cid-3nssi2tu> <a href="/workbench" class="block p-4 border border-gray-300 rounded-lg hover:border-blue-500 hover:shadow-md transition-all" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <span class="text-3xl mb-2 block" data-astro-cid-3nssi2tu>🔧</span> <p class="font-medium text-gray-900" data-astro-cid-3nssi2tu>工作台</p> <p class="text-sm text-gray-500" data-astro-cid-3nssi2tu>编辑管理文章</p> </div> </a> <a href="/test" class="block p-4 border border-gray-300 rounded-lg hover:border-green-500 hover:shadow-md transition-all" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <span class="text-3xl mb-2 block" data-astro-cid-3nssi2tu>🧪</span> <p class="font-medium text-gray-900" data-astro-cid-3nssi2tu>RSS测试</p> <p class="text-sm text-gray-500" data-astro-cid-3nssi2tu>测试RSS源</p> </div> </a> <a href="/test-claude" class="block p-4 border border-gray-300 rounded-lg hover:border-purple-500 hover:shadow-md transition-all" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <span class="text-3xl mb-2 block" data-astro-cid-3nssi2tu>🤖</span> <p class="font-medium text-gray-900" data-astro-cid-3nssi2tu>AI测试</p> <p class="text-sm text-gray-500" data-astro-cid-3nssi2tu>Claude AI功能</p> </div> </a> <button id="refresh-stats" class="p-4 border border-gray-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <span class="text-3xl mb-2 block" data-astro-cid-3nssi2tu>🔄</span> <p class="font-medium text-gray-900" data-astro-cid-3nssi2tu>刷新数据</p> <p class="text-sm text-gray-500" data-astro-cid-3nssi2tu>更新统计</p> </div> </button> </div> </div> </div>    ` })}`;
}, "/Users/simianwang/Desktop/latest-feed/src/pages/dashboard.astro", void 0);

const $$file = "/Users/simianwang/Desktop/latest-feed/src/pages/dashboard.astro";
const $$url = "/dashboard";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Dashboard,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
