/* empty css                                    */
import { c as createComponent, a as createAstro, f as renderComponent, e as renderTemplate, g as defineScriptVars, b as addAttribute, m as maybeRenderHead } from '../chunks/astro/server_BM2aJuEc.mjs';
import { $ as $$Layout } from '../chunks/Layout_D7fvp0Pm.mjs';
import { s as supabase } from '../chunks/supabase_DhlB0YS7.mjs';
export { renderers } from '../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$Test = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Test;
  const { data: rssResources } = await supabase.from("rss_resources").select("*").order("success_rate", { ascending: false });
  const url = Astro2.url;
  const categoryFilter = url.searchParams.get("category") || "all";
  const statusFilter = url.searchParams.get("status") || "all";
  const regionFilter = url.searchParams.get("region") || "all";
  const strategyFilter = url.searchParams.get("strategy") || "all";
  const categories = [...new Set(rssResources?.map((r) => r.category).filter(Boolean) || [])];
  const regions = [...new Set(rssResources?.map((r) => r.region).filter(Boolean) || [])];
  const strategies = [...new Set(rssResources?.map((r) => r.crawl_strategy).filter(Boolean) || [])];
  let filteredResources = rssResources || [];
  if (categoryFilter !== "all") {
    filteredResources = filteredResources.filter((r) => r.category === categoryFilter);
  }
  if (statusFilter !== "all") {
    const isActive = statusFilter === "active";
    filteredResources = filteredResources.filter((r) => r.is_active === isActive);
  }
  if (regionFilter !== "all") {
    filteredResources = filteredResources.filter((r) => r.region === regionFilter);
  }
  if (strategyFilter !== "all") {
    filteredResources = filteredResources.filter((r) => r.crawl_strategy === strategyFilter);
  }
  const totalSources = rssResources?.length || 0;
  const activeSources = rssResources?.filter((r) => r.is_active).length || 0;
  const filteredCount = filteredResources.length;
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "RSS\u6E90\u7BA1\u7406 - \u5236\u9020\u4E1A\u60C5\u62A5\u7CFB\u7EDF" }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", '<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"> <!-- \u9875\u9762\u6807\u9898 --> <div class="mb-8"> <h1 class="text-3xl font-bold text-gray-900">\u{1F4E1} RSS\u6E90\u7BA1\u7406</h1> <p class="mt-2 text-gray-600">\u7BA1\u7406\u548C\u76D1\u63A7\u5236\u9020\u4E1A\u60C5\u62A5RSS\u6E90</p> </div> <!-- \u7EDF\u8BA1\u5361\u7247 --> <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-blue-100 rounded-lg"> <span class="text-2xl">\u{1F4E1}</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u603BRSS\u6E90</p> <p class="text-2xl font-semibold text-gray-900">', '</p> </div> </div> </div> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-green-100 rounded-lg"> <span class="text-2xl">\u2705</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u6FC0\u6D3B\u6E90</p> <p class="text-2xl font-semibold text-gray-900">', '</p> </div> </div> </div> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-yellow-100 rounded-lg"> <span class="text-2xl">\u{1F50D}</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u7B5B\u9009\u7ED3\u679C</p> <p class="text-2xl font-semibold text-gray-900">', '</p> </div> </div> </div> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-purple-100 rounded-lg"> <span class="text-2xl">\u{1F4CA}</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u5065\u5EB7\u5EA6</p> <p class="text-2xl font-semibold text-gray-900"> ', '%\n</p> </div> </div> </div> </div> <!-- \u7B5B\u9009\u9762\u677F --> <div class="bg-white shadow rounded-lg mb-6 p-6"> <div class="grid grid-cols-1 md:grid-cols-5 gap-4"> <!-- \u5206\u7C7B\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u5206\u7C7B</label> <select id="category-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u5206\u7C7B</option> ', ' </select> </div> <!-- \u72B6\u6001\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u72B6\u6001</label> <select id="status-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u72B6\u6001</option> <option value="active"', '>\u6FC0\u6D3B</option> <option value="inactive"', '>\u672A\u6FC0\u6D3B</option> </select> </div> <!-- \u5730\u533A\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u5730\u533A</label> <select id="region-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u5730\u533A</option> ', ' </select> </div> <!-- \u6293\u53D6\u7B56\u7565\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u6293\u53D6\u7B56\u7565</label> <select id="strategy-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u7B56\u7565</option> ', ' </select> </div> <!-- \u64CD\u4F5C\u6309\u94AE --> <div class="flex items-end"> <button id="apply-filters" class="w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">\n\u5E94\u7528\u7B5B\u9009\n</button> </div> </div> <!-- \u64CD\u4F5C\u6309\u94AE\u884C --> <div class="flex space-x-4 mt-4 pt-4 border-t border-gray-200"> <button id="test-all-sources" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">\n\u6D4B\u8BD5\u6240\u6709\u6E90\n</button> <button id="health-check" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">\n\u5065\u5EB7\u68C0\u67E5\n</button> <button id="refresh-data" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">\n\u5237\u65B0\u6570\u636E\n</button> <button id="add-source" class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600">\n\u6DFB\u52A0\u6E90\n</button> </div> </div> <!-- RSS\u6E90\u5217\u8868 --> <div class="bg-white shadow rounded-lg overflow-hidden"> <div class="px-6 py-4 border-b border-gray-200"> <h3 class="text-lg font-medium text-gray-900">\nRSS\u6E90\u5217\u8868 (', ' \u6761\u8BB0\u5F55)\n</h3> </div> <div class="overflow-x-auto"> <table class="min-w-full divide-y divide-gray-200"> <thead class="bg-gray-50"> <tr> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u6E90\u4FE1\u606F\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u5206\u7C7B\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u5730\u533A\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u6293\u53D6\u7B56\u7565\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u72B6\u6001\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u6210\u529F\u7387\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u64CD\u4F5C\n</th> </tr> </thead> <tbody class="bg-white divide-y divide-gray-200"> ', " </tbody> </table> </div> ", ' </div> <!-- \u6D4B\u8BD5\u7ED3\u679C\u9762\u677F --> <div id="test-results" class="hidden mt-8 bg-white shadow rounded-lg"> <div class="px-6 py-4 border-b border-gray-200"> <h3 class="text-lg font-medium text-gray-900">\u6D4B\u8BD5\u7ED3\u679C</h3> </div> <div id="test-results-content" class="p-6 max-h-96 overflow-y-auto"></div> </div> </div> <script>(function(){', "\n    // \u7B5B\u9009\u529F\u80FD\n    document.getElementById('apply-filters').addEventListener('click', () => {\n      const category = document.getElementById('category-filter').value\n      const status = document.getElementById('status-filter').value\n      const region = document.getElementById('region-filter').value\n      const strategy = document.getElementById('strategy-filter').value\n      \n      const params = new URLSearchParams()\n      if (category !== 'all') params.append('category', category)\n      if (status !== 'all') params.append('status', status)\n      if (region !== 'all') params.append('region', region)\n      if (strategy !== 'all') params.append('strategy', strategy)\n      \n      window.location.href = `/test?${params.toString()}`\n    })\n\n    // \u6D4B\u8BD5\u5355\u4E2A\u6E90\n    async function testSource(sourceId) {\n      const statusElement = document.querySelector(`.test-status-${sourceId}`)\n      statusElement.textContent = '\u6D4B\u8BD5\u4E2D...'\n      statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-yellow-600'\n      \n      try {\n        const response = await fetch('/api/test-crawl', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ sourceId })\n        })\n        \n        const result = await response.json()\n        \n        if (result.success) {\n          statusElement.textContent = '\u2705 \u6210\u529F'\n          statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-green-600'\n        } else {\n          statusElement.textContent = '\u274C \u5931\u8D25'\n          statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-red-600'\n        }\n        \n        showTestResult(sourceId, result)\n        \n      } catch (error) {\n        statusElement.textContent = '\u274C \u9519\u8BEF'\n        statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-red-600'\n        console.error('\u6D4B\u8BD5\u5931\u8D25:', error)\n      }\n    }\n\n    // \u5207\u6362\u6E90\u72B6\u6001\n    async function toggleSource(sourceId, newStatus) {\n      try {\n        const response = await fetch('/api/rss-sources/toggle', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ sourceId, isActive: newStatus })\n        })\n        \n        if (response.ok) {\n          location.reload()\n        } else {\n          alert('\u64CD\u4F5C\u5931\u8D25')\n        }\n      } catch (error) {\n        console.error('\u5207\u6362\u72B6\u6001\u5931\u8D25:', error)\n        alert('\u64CD\u4F5C\u5931\u8D25')\n      }\n    }\n\n    // \u7F16\u8F91\u6E90\n    function editSource(sourceId) {\n      // TODO: \u5B9E\u73B0\u7F16\u8F91\u529F\u80FD\n      alert(`\u7F16\u8F91\u6E90: ${sourceId}`)\n    }\n\n    // \u6D4B\u8BD5\u6240\u6709\u6E90\n    document.getElementById('test-all-sources').addEventListener('click', async () => {\n      const activeSourceIds = rssResourcesData.filter(s => s.is_active).map(s => s.id)\n      \n      for (const sourceId of activeSourceIds) {\n        await testSource(sourceId)\n        await new Promise(resolve => setTimeout(resolve, 1000)) // \u907F\u514D\u8FC7\u4E8E\u9891\u7E41\u7684\u8BF7\u6C42\n      }\n    })\n    \n    // \u5065\u5EB7\u68C0\u67E5\n    document.getElementById('health-check').addEventListener('click', async () => {\n      try {\n        const response = await fetch('/api/test-crawl?action=health')\n        const result = await response.json()\n        showTestResult('health-check', result)\n      } catch (error) {\n        console.error('\u5065\u5EB7\u68C0\u67E5\u5931\u8D25:', error)\n      }\n    })\n\n    // \u5237\u65B0\u6570\u636E\n    document.getElementById('refresh-data').addEventListener('click', () => {\n      location.reload()\n    })\n\n    // \u6DFB\u52A0\u6E90\n    document.getElementById('add-source').addEventListener('click', () => {\n      // TODO: \u5B9E\u73B0\u6DFB\u52A0\u6E90\u529F\u80FD\n      alert('\u6DFB\u52A0\u65B0RSS\u6E90\u529F\u80FD\u5F00\u53D1\u4E2D...')\n    })\n    \n    // \u663E\u793A\u6D4B\u8BD5\u7ED3\u679C\n    function showTestResult(sourceId, result) {\n      const resultsPanel = document.getElementById('test-results')\n      const resultsContent = document.getElementById('test-results-content')\n      \n      resultsPanel.classList.remove('hidden')\n      \n      const resultDiv = document.createElement('div')\n      resultDiv.className = 'mb-4 p-4 border rounded-lg ' + (result.success ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50')\n      resultDiv.innerHTML = `\n        <h4 class=\"font-medium ${result.success ? 'text-green-800' : 'text-red-800'}\">${sourceId}</h4>\n        <pre class=\"text-sm mt-2 whitespace-pre-wrap max-h-40 overflow-y-auto\">${JSON.stringify(result, null, 2)}</pre>\n      `\n      \n      resultsContent.appendChild(resultDiv)\n      resultsContent.scrollTop = resultsContent.scrollHeight\n    }\n    \n    // \u7ED1\u5B9A\u5230window\u4EE5\u4F9Bonclick\u4F7F\u7528\n    window.testSource = testSource\n    window.toggleSource = toggleSource\n    window.editSource = editSource\n  })();<\/script> "], [" ", '<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"> <!-- \u9875\u9762\u6807\u9898 --> <div class="mb-8"> <h1 class="text-3xl font-bold text-gray-900">\u{1F4E1} RSS\u6E90\u7BA1\u7406</h1> <p class="mt-2 text-gray-600">\u7BA1\u7406\u548C\u76D1\u63A7\u5236\u9020\u4E1A\u60C5\u62A5RSS\u6E90</p> </div> <!-- \u7EDF\u8BA1\u5361\u7247 --> <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-blue-100 rounded-lg"> <span class="text-2xl">\u{1F4E1}</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u603BRSS\u6E90</p> <p class="text-2xl font-semibold text-gray-900">', '</p> </div> </div> </div> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-green-100 rounded-lg"> <span class="text-2xl">\u2705</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u6FC0\u6D3B\u6E90</p> <p class="text-2xl font-semibold text-gray-900">', '</p> </div> </div> </div> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-yellow-100 rounded-lg"> <span class="text-2xl">\u{1F50D}</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u7B5B\u9009\u7ED3\u679C</p> <p class="text-2xl font-semibold text-gray-900">', '</p> </div> </div> </div> <div class="bg-white rounded-lg shadow p-6"> <div class="flex items-center"> <div class="p-2 bg-purple-100 rounded-lg"> <span class="text-2xl">\u{1F4CA}</span> </div> <div class="ml-4"> <p class="text-sm font-medium text-gray-600">\u5065\u5EB7\u5EA6</p> <p class="text-2xl font-semibold text-gray-900"> ', '%\n</p> </div> </div> </div> </div> <!-- \u7B5B\u9009\u9762\u677F --> <div class="bg-white shadow rounded-lg mb-6 p-6"> <div class="grid grid-cols-1 md:grid-cols-5 gap-4"> <!-- \u5206\u7C7B\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u5206\u7C7B</label> <select id="category-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u5206\u7C7B</option> ', ' </select> </div> <!-- \u72B6\u6001\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u72B6\u6001</label> <select id="status-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u72B6\u6001</option> <option value="active"', '>\u6FC0\u6D3B</option> <option value="inactive"', '>\u672A\u6FC0\u6D3B</option> </select> </div> <!-- \u5730\u533A\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u5730\u533A</label> <select id="region-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u5730\u533A</option> ', ' </select> </div> <!-- \u6293\u53D6\u7B56\u7565\u7B5B\u9009 --> <div> <label class="block text-sm font-medium text-gray-700 mb-2">\u6293\u53D6\u7B56\u7565</label> <select id="strategy-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"> <option value="all">\u5168\u90E8\u7B56\u7565</option> ', ' </select> </div> <!-- \u64CD\u4F5C\u6309\u94AE --> <div class="flex items-end"> <button id="apply-filters" class="w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">\n\u5E94\u7528\u7B5B\u9009\n</button> </div> </div> <!-- \u64CD\u4F5C\u6309\u94AE\u884C --> <div class="flex space-x-4 mt-4 pt-4 border-t border-gray-200"> <button id="test-all-sources" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">\n\u6D4B\u8BD5\u6240\u6709\u6E90\n</button> <button id="health-check" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">\n\u5065\u5EB7\u68C0\u67E5\n</button> <button id="refresh-data" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">\n\u5237\u65B0\u6570\u636E\n</button> <button id="add-source" class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600">\n\u6DFB\u52A0\u6E90\n</button> </div> </div> <!-- RSS\u6E90\u5217\u8868 --> <div class="bg-white shadow rounded-lg overflow-hidden"> <div class="px-6 py-4 border-b border-gray-200"> <h3 class="text-lg font-medium text-gray-900">\nRSS\u6E90\u5217\u8868 (', ' \u6761\u8BB0\u5F55)\n</h3> </div> <div class="overflow-x-auto"> <table class="min-w-full divide-y divide-gray-200"> <thead class="bg-gray-50"> <tr> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u6E90\u4FE1\u606F\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u5206\u7C7B\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u5730\u533A\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u6293\u53D6\u7B56\u7565\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u72B6\u6001\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u6210\u529F\u7387\n</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">\n\u64CD\u4F5C\n</th> </tr> </thead> <tbody class="bg-white divide-y divide-gray-200"> ', " </tbody> </table> </div> ", ' </div> <!-- \u6D4B\u8BD5\u7ED3\u679C\u9762\u677F --> <div id="test-results" class="hidden mt-8 bg-white shadow rounded-lg"> <div class="px-6 py-4 border-b border-gray-200"> <h3 class="text-lg font-medium text-gray-900">\u6D4B\u8BD5\u7ED3\u679C</h3> </div> <div id="test-results-content" class="p-6 max-h-96 overflow-y-auto"></div> </div> </div> <script>(function(){', "\n    // \u7B5B\u9009\u529F\u80FD\n    document.getElementById('apply-filters').addEventListener('click', () => {\n      const category = document.getElementById('category-filter').value\n      const status = document.getElementById('status-filter').value\n      const region = document.getElementById('region-filter').value\n      const strategy = document.getElementById('strategy-filter').value\n      \n      const params = new URLSearchParams()\n      if (category !== 'all') params.append('category', category)\n      if (status !== 'all') params.append('status', status)\n      if (region !== 'all') params.append('region', region)\n      if (strategy !== 'all') params.append('strategy', strategy)\n      \n      window.location.href = \\`/test?\\${params.toString()}\\`\n    })\n\n    // \u6D4B\u8BD5\u5355\u4E2A\u6E90\n    async function testSource(sourceId) {\n      const statusElement = document.querySelector(\\`.test-status-\\${sourceId}\\`)\n      statusElement.textContent = '\u6D4B\u8BD5\u4E2D...'\n      statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-yellow-600'\n      \n      try {\n        const response = await fetch('/api/test-crawl', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ sourceId })\n        })\n        \n        const result = await response.json()\n        \n        if (result.success) {\n          statusElement.textContent = '\u2705 \u6210\u529F'\n          statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-green-600'\n        } else {\n          statusElement.textContent = '\u274C \u5931\u8D25'\n          statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-red-600'\n        }\n        \n        showTestResult(sourceId, result)\n        \n      } catch (error) {\n        statusElement.textContent = '\u274C \u9519\u8BEF'\n        statusElement.className = 'test-status-' + sourceId + ' text-xs mt-1 text-red-600'\n        console.error('\u6D4B\u8BD5\u5931\u8D25:', error)\n      }\n    }\n\n    // \u5207\u6362\u6E90\u72B6\u6001\n    async function toggleSource(sourceId, newStatus) {\n      try {\n        const response = await fetch('/api/rss-sources/toggle', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ sourceId, isActive: newStatus })\n        })\n        \n        if (response.ok) {\n          location.reload()\n        } else {\n          alert('\u64CD\u4F5C\u5931\u8D25')\n        }\n      } catch (error) {\n        console.error('\u5207\u6362\u72B6\u6001\u5931\u8D25:', error)\n        alert('\u64CD\u4F5C\u5931\u8D25')\n      }\n    }\n\n    // \u7F16\u8F91\u6E90\n    function editSource(sourceId) {\n      // TODO: \u5B9E\u73B0\u7F16\u8F91\u529F\u80FD\n      alert(\\`\u7F16\u8F91\u6E90: \\${sourceId}\\`)\n    }\n\n    // \u6D4B\u8BD5\u6240\u6709\u6E90\n    document.getElementById('test-all-sources').addEventListener('click', async () => {\n      const activeSourceIds = rssResourcesData.filter(s => s.is_active).map(s => s.id)\n      \n      for (const sourceId of activeSourceIds) {\n        await testSource(sourceId)\n        await new Promise(resolve => setTimeout(resolve, 1000)) // \u907F\u514D\u8FC7\u4E8E\u9891\u7E41\u7684\u8BF7\u6C42\n      }\n    })\n    \n    // \u5065\u5EB7\u68C0\u67E5\n    document.getElementById('health-check').addEventListener('click', async () => {\n      try {\n        const response = await fetch('/api/test-crawl?action=health')\n        const result = await response.json()\n        showTestResult('health-check', result)\n      } catch (error) {\n        console.error('\u5065\u5EB7\u68C0\u67E5\u5931\u8D25:', error)\n      }\n    })\n\n    // \u5237\u65B0\u6570\u636E\n    document.getElementById('refresh-data').addEventListener('click', () => {\n      location.reload()\n    })\n\n    // \u6DFB\u52A0\u6E90\n    document.getElementById('add-source').addEventListener('click', () => {\n      // TODO: \u5B9E\u73B0\u6DFB\u52A0\u6E90\u529F\u80FD\n      alert('\u6DFB\u52A0\u65B0RSS\u6E90\u529F\u80FD\u5F00\u53D1\u4E2D...')\n    })\n    \n    // \u663E\u793A\u6D4B\u8BD5\u7ED3\u679C\n    function showTestResult(sourceId, result) {\n      const resultsPanel = document.getElementById('test-results')\n      const resultsContent = document.getElementById('test-results-content')\n      \n      resultsPanel.classList.remove('hidden')\n      \n      const resultDiv = document.createElement('div')\n      resultDiv.className = 'mb-4 p-4 border rounded-lg ' + (result.success ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50')\n      resultDiv.innerHTML = \\`\n        <h4 class=\"font-medium \\${result.success ? 'text-green-800' : 'text-red-800'}\">\\${sourceId}</h4>\n        <pre class=\"text-sm mt-2 whitespace-pre-wrap max-h-40 overflow-y-auto\">\\${JSON.stringify(result, null, 2)}</pre>\n      \\`\n      \n      resultsContent.appendChild(resultDiv)\n      resultsContent.scrollTop = resultsContent.scrollHeight\n    }\n    \n    // \u7ED1\u5B9A\u5230window\u4EE5\u4F9Bonclick\u4F7F\u7528\n    window.testSource = testSource\n    window.toggleSource = toggleSource\n    window.editSource = editSource\n  })();<\/script> "])), maybeRenderHead(), totalSources, activeSources, filteredCount, totalSources > 0 ? Math.round(activeSources / totalSources * 100) : 0, categories.map((category) => renderTemplate`<option${addAttribute(category, "value")}${addAttribute(categoryFilter === category, "selected")}> ${category} </option>`), addAttribute(statusFilter === "active", "selected"), addAttribute(statusFilter === "inactive", "selected"), regions.map((region) => renderTemplate`<option${addAttribute(region, "value")}${addAttribute(regionFilter === region, "selected")}> ${region} </option>`), strategies.map((strategy) => renderTemplate`<option${addAttribute(strategy, "value")}${addAttribute(strategyFilter === strategy, "selected")}> ${strategy} </option>`), filteredCount, filteredResources.map((source) => renderTemplate`<tr class="hover:bg-gray-50"> <td class="px-6 py-4 whitespace-nowrap"> <div class="flex items-center"> <div class="flex-shrink-0"> <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-gray-500"> <span class="text-sm font-medium leading-none text-white"> ${source.name?.charAt(0) || "R"} </span> </span> </div> <div class="ml-4 min-w-0"> <div class="text-sm font-medium text-gray-900 truncate max-w-xs"> ${source.name} </div> <div class="text-sm text-gray-500 truncate max-w-xs"> ${source.url} </div> ${source.description && renderTemplate`<div class="text-xs text-gray-400 mt-1 max-w-xs truncate"> ${source.description} </div>`} </div> </div> </td> <td class="px-6 py-4 whitespace-nowrap"> <span${addAttribute(`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${source.category === "Technology" ? "bg-blue-100 text-blue-800" : source.category === "Business" ? "bg-green-100 text-green-800" : source.category === "Policy" ? "bg-purple-100 text-purple-800" : "bg-gray-100 text-gray-800"}`, "class")}> ${source.category} </span> </td> <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> ${source.region} </td> <td class="px-6 py-4 whitespace-nowrap"> <span${addAttribute(`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${source.crawl_strategy === "google_news" ? "bg-yellow-100 text-yellow-800" : source.crawl_strategy === "anti_scraping" ? "bg-red-100 text-red-800" : source.crawl_strategy === "javascript_heavy" ? "bg-orange-100 text-orange-800" : "bg-gray-100 text-gray-800"}`, "class")}> ${source.crawl_strategy} </span> </td> <td class="px-6 py-4 whitespace-nowrap"> <span${addAttribute(`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${source.is_active ? "bg-green-100 text-green-800" : "bg-red-100 text-red-800"}`, "class")}> <span${addAttribute(`w-1.5 h-1.5 rounded-full mr-1 ${source.is_active ? "bg-green-400" : "bg-red-400"}`, "class")}></span> ${source.is_active ? "\u6FC0\u6D3B" : "\u672A\u6FC0\u6D3B"} </span> <div class="text-xs text-gray-500 mt-1"> ${source.last_fetch ? `\u6700\u540E\u6293\u53D6: ${new Date(source.last_fetch).toLocaleDateString("zh-CN")}` : "\u672A\u6293\u53D6"} </div> </td> <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> ${source.success_rate ? renderTemplate`<div class="flex items-center"> <div class="flex-1"> <div class="flex items-center justify-between text-xs mb-1"> <span>${source.success_rate}%</span> </div> <div class="w-full bg-gray-200 rounded-full h-1.5"> <div${addAttribute(`h-1.5 rounded-full ${source.success_rate >= 80 ? "bg-green-400" : source.success_rate >= 60 ? "bg-yellow-400" : "bg-red-400"}`, "class")}${addAttribute(`width: ${source.success_rate}%`, "style")}></div> </div> </div> </div>` : renderTemplate`<span class="text-gray-500">-</span>`} </td> <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"> <div class="flex space-x-2"> <button${addAttribute(`testSource('${source.id}')`, "onclick")} class="text-blue-600 hover:text-blue-900 text-xs bg-blue-50 hover:bg-blue-100 px-2 py-1 rounded">
测试
</button> <button${addAttribute(`toggleSource('${source.id}', ${!source.is_active})`, "onclick")}${addAttribute(`text-xs px-2 py-1 rounded ${source.is_active ? "text-red-600 hover:text-red-900 bg-red-50 hover:bg-red-100" : "text-green-600 hover:text-green-900 bg-green-50 hover:bg-green-100"}`, "class")}> ${source.is_active ? "\u505C\u7528" : "\u542F\u7528"} </button> <button${addAttribute(`editSource('${source.id}')`, "onclick")} class="text-gray-600 hover:text-gray-900 text-xs bg-gray-50 hover:bg-gray-100 px-2 py-1 rounded">
编辑
</button> </div> <div${addAttribute(`test-status-${source.id} text-xs mt-1`, "class")}></div> </td> </tr>`), filteredResources.length === 0 && renderTemplate`<div class="text-center py-12"> <span class="text-4xl mb-4 block">📭</span> <p class="text-gray-500">没有找到符合条件的RSS源</p> </div>`, defineScriptVars({ rssResourcesData: filteredResources })) })}`;
}, "/Users/simianwang/Desktop/latest-feed/src/pages/test.astro", void 0);

const $$file = "/Users/simianwang/Desktop/latest-feed/src/pages/test.astro";
const $$url = "/test";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Test,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
